<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Ea</title>
  <link rel="stylesheet" href="bulma.min.css" />
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="data.js"></script>
  <script src="fuse.js"></script>
</head>

<body>
  <h1 class="title is-1 has-text-centered">Long list</h1>
  <div class="long-list">
    <input v-on:change="onChange" autocomplete="off" class="input" name="search" id="search" placeholder="Search..."/>
    <ul id="list">
      <li v-for="item in items">
        <div class="card">
          <div class="card-content">
            <div class="media">
              <div class="media-content">
                <p class="title is-4">{{item.name}}</p>
                <p class="subtitle is-6">{{item.email}}</p>
              </div>
            </div>
          </div>
        </div>
      </li>
    </ul>
  </div>
  <script>
    const worker = new Worker('worker.js');

    // const options = {
    //     keys: ['name', 'email'],
    // };

    // const fuse = new Fuse(data, options);

    var longList = new Vue({
      el: '.long-list',
      data: {
        items: data.slice(0, 10)
      },
      methods: {
        onChange: function (event) {

          // this.items = fuse.search(event.target.value).slice(0, 10);

          worker.postMessage({search: event.target.value, data})

          worker.onmessage = ({data}) => {
            this.items = data.filteredList
          };
        }
      }
    })
  </script>
</body>

</html>
